# 3d liquid lennard Jones
variable        dt equal 0.005
variable        T equal 1.05
variable        b equal 5.7e-10
variable        s equal 3.405e-10
variable        rho equal 4/$b^3*$s^3
variable        x equal 20
variable        y equal 20
variable        z equal 20
variable        r equal 2e-9/$s/xlat
variable        N equal 10000

units           lj
dimension       3
boundary        p p p
atom_style      atomic

lattice         fcc ${rho}
region          simbox block 0 $x 0 $y 0 $z
create_box      2 simbox
create_atoms    1 box

mass            1 1.0
mass            2 1.0

velocity        all create ${T} 42 dist uniform

pair_style      lj/cut 3.0
pair_coeff      * * 1.0 1.0 3.0

# --------------------------- Thermalize ---------------------------------------
fix             fixnvt all nvt temp ${T} ${T} $(1.0*dt)

# --------------------------- Equilibriate -------------------------------------
thermo_style    custom cpu
run             2000

# Cylinder pore
region          pore cylinder x $(20/2) $(20/2) $r INF INF
# Delete half the atoms in the pore
delete_atoms    porosity pore 0.5 42

# Three groups: 1) cylinder 2) whole box 3) whole box - cylinder
group           pore_group region pore
group           gbox region simbox
group           outside_pore subtract gbox pore_group
set             group pore_group type 2

fix             fixForce pore_group addforce 0.1 0.0 0.0

# --------------------------- Equilibriate -------------------------------------
thermo_style    custom cpu
run             2000
reset_timestep  0

unfix           fixnvt

fix             fixSetForce outside_pore setforce 0.0 0.0 0.0
velocity        outside_pore set 0.0 0.0 0.0


fix             fixnve pore_group nve# temp $T $T $(1.0*dt)

thermo          100
thermo_style    custom step temp time
dump            1 pore_group custom 100 dump.task_b id type x y z vx vy vz
run             $N
